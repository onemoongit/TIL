# 커넥션 관리

- HTTP는 어떻게 TCP 커넥션을 사용하는가
- TCP 커넥션의 지연, 병목, 막힘
- 병렬 커넥션, keep-alive 커넥션, 커넥션 파이프라인을 활용한 HTTP의 최적화
- 커넥션 관리를 위해 따라야 할 규칙들

## TCP 커넥션

세계 어디서든 클라이언트와 서버는 TCP/IP 커넥션을 맺을 수 있고, 일단 이 커넥션이 맺어진다면 클라이언트와 서버 컴퓨터간에 주고 받는 메시지들은 손실 혹은 손상되지 않는다.

###### TCP 커넥션의 한쪽에 있는 바이트들은 반대쪽으로 순서에 맞게 정확히 전달된다.

###### TCP 스트림은 세그먼트로 나뉘어 IP 패킷을 통해 전송된다.

TCP는 IP패킷 혹은 IP 데이터그램 이라고 불리는 작은 조각을 통해 데이터를 전송한다.

| HTTP | HTTPS | STACK |
| :---: | :---: | :---: |
| HTTP | HTTP | 애플리케이션 계층 |
|  | TLS or SSL | 보안 계층 |
| TCP | TCP | 전송 계층 |
| IP | IP | 네트워크 계층 |
| Network Interfaces | Network Interfaces | 데이터 링크 계층 |

HTTP 는 메시지를 전송하고자 할 경우 , 현재 연결되어 있는 TCP 커넥션을 통해서 메시지 데이터의 내용을 순서대로 보낸다. TCP는 세그먼트라는 단위로 데이터 스트림을 잘게 나누고 , 세그먼트를 IP 패킷이라고 불리는 봉투에 담아서 인터넷을 통해 데이터를 전달한다.

IP 패킷들은 다음을 포함한다.
- IP 패킷 헤더
- TCP 세그먼트 헤더
- TCP 데이터 조각

###### TCP 커넥션 유지하기

컴퓨터는 항상 TCP 커넥션을 여러개 가지고 있고 TCP는 포트 번호를 통해서 이런 여러 개의 커넥션을 유지한다.

TCP 커넥션은 네가지 값으로 식별한다.
`< 발신지 IP 주소 , 발신지 포트 , 수신지 IP 주소 , 수신지 포트 >`
이 네가지 값으로 유일한 커넥션을 생성한다.

###### TCP 소켓 프로그래밍
