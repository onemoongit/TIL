# AWS
## EC2에 대해서 간단하게 알아보자

### AWS 의 대표 서비스

가장 범용적이고 한마디로 여러가지를 할수 있다.

인스턴스 하나당 한대의 컴퓨터라고 생각하는것이 편하다.

### EC2를 생성해보자

ec2 의 기본 설정들을 따라가면 편하다.

나는 기본적인 ubuntu 인스턴스를 생성했고 프리티어가 가능한 것들이 나와있으니 참고

따라가다보면 configuration security group 에서 http를 추가했다.

마지막에 key를 만드는게 있는데 key 이름을 만들고 다운로드 하면 비밀번호가 다운로드 된다.
(나는 맥 사용자인데 예를들어 key 이름이 onemoon 이라면 onemoon.pem이 다운로드 될것이다.)

완료되면 EC2 인스턴스 생성이 될것이다. 아래는 각 스텝별 간단한 설명을 적어놨다.

### choose AMI 

운영체제를 선택하는것 크게 두가지가 있다

unix 운영체제를 뿌리로 하는 linux가 있고, window가 있다.

### instance type

vcpu는 몇개의 cpu가 있는가 memory는 말 그대로 메모리의 크기

vcpu는 virtual cpu다 참고로 알아두자 

타입중에 c숫자 , m숫자가 있는데 (다른 것도 있음) c같은 경우는 cpu에 강점을 가지고 있고 , m같은 경우는 memory에 강점이 있다는 의미라는것을 알아두자

### configure instance

몇개의 인스턴스를 만들것인지 , spot instance를 사용할 것인지 네트워크 혹은 다른 설정들을 해준다.

shutdown behavior 를 통해서 stop을 할것인지 terminate를 할것인지 설정할 수도 있다.

### storage

저장장치를 얼마나 장착할 것인지 설정해주는곳 ebs를 장착한다. 

Size 30 기가 까지는 무료이다.
delete on termiation 은 terminate할때 저장장치 또한 삭제가 된다. 체크시에는 내장하드 같은 느낌이다. 체크를 안할시에는 외장 하드라고 생각하면 편하다.

### tag instance

인스턴스가 어떤 역할인지 누가 관리하는지 등 정보들을 적어놓고 싶을 때 사용한다.

### configuration security group

보안과 관련된 부분 인스턴스에 접근하는 권한을 설정한다.

접속할 수 있는 방식을 설정하는데 security group 을 먼저 설정한다.

type은 여러가지를 설정할 수 있으며 기본적으로 ssh가 설정되어 있다. 웹서버로 사용하고 싶다면 http 를 설정하면 된다. SSH 는 리눅스 용이고 , RDP는 윈도우 용이라는것 또한 알아두자

source를 눌러서 My ip를 설정하게 되면 내 컴퓨터에서만 제어를 가능하게 한다. custom ip를 통해서 다른 ip 사용 또한 가능하다

### review 

쉽게 얘기하자면 비밀번호를 지정한다. keypair 를 설정할 수 있는데 , 파일로 저장이 된다. 

이 .pem 파일은 한번 발급을 받으면 다시는 발급을 받을 수 없다고 하니 잘 보관해 둬야 한다.


### 가격정책

프리티어

1대의 인스턴스를 하루종일 켜놔도 1년동안 무료이다. 750시간이므로 한번도 안끄더라도 무방하다.

[aws 가격정책](https://aws.amazon.com/ko/ec2/pricing/)에서 요금을 확인할 수 있는데

온디맨드는 자신이 마음대로 끄고 킬수 있는 인스턴스에 대한 요금을 부과하고 ,

예약인스턴스는 할인이 적용되는데 언제 키고 끌건지를 설정할 수 있다. 예를들어 1년동안 한번도 쓰지 않는다면 그대로 설정하고 쓸수 있다.

스팟인스턴스는 필요할때마다 켜고 끌수 있는데 한마디로 aws에서 노는컴퓨터를 사용한다는 뜻인데 노는컴퓨터가 많다면 가격이 저렴해지고 노는컴퓨터가 별로 없다면 일반 인스턴스보다 더 높은가격이 측정된다. 

### 원격제어

#### mac에서 linux instance 접속하기 

인스턴스에서 오른쪽클릭을 하면 connect가 있다.

ssh client 툴이 필요한데 맥에서는 기본적으로 terminal에서 사용가능하다.

해당 폴더로 이동 한뒤에 aws 콘솔에 적혀있는 명령어를 sudo를 붙여 사용하자 (chmode 400 ~)

chmod 400의 의미

현재 사용자만 이 파일을 알수 있고, 다른 사용자들은 존재하는지 조차 파악 못하게끔 만들어라 라는 의미이다.

그다음 접속 명령어를 살펴보자

ssh -i "hello_pwd.pem" ubuntu@---.amazonaws.com

ssh는 접속 방식이면서 프로그램이다. 이 프로그램은 명령을 통해서만 제어할 수 있다. 

-i 라는 옵션을 통해서 비밀번호를 제출할 수 있고, 바로 뒤에 비밀번호를 제출한다.
그리고 그 뒤에 id와 ip를 입력한다.

예제에서는 ubuntu가 id가 되는것이고 @ 뒤에 값은 ip가 되는것이다. 그리고 비밀번호는 @@@.pem이다.

id값은 aws에서 변경이 가능하다. 만약 설치한 인스턴스가 우분투가 아니라면 ubuntu 대신에 ec2-user를 사용하면 된다. 

값을 입력하면 aws 로 만든 우분투 인스턴스를 사용할 수 있고 , exit를 입력하면 나오게 된다. 

### mac에서 window 서버 접속하기

인스턴스를 설정할때 security group에서 rdp가 설정되었는지 확인한다.

접속하려는 컴퓨터의 ip가 있고, username이 있다. get password를 누르고 난 뒤에 pem 파일을 선택해준다. 그다음 decypt password 를 누르면 간단한 password가 나타난다.

맥에서 원활한 접속을 위해 microsoft remote desktop 앱을 설치해준다. 

해당앱에서 설정을 한 뒤에 , 해당 항목을 더블클릭한다면 윈도우 서버에 접속할 수 있다.

! 윈도우에서는 ie에 접속할 때 경고를 계속 보낸다 . 이를 해제하고 싶다면 server manager를 누르고 Localserver에서 IE enhanced security configuration 을 off해준다. 이렇게하면 보안적으로 취약해지지만 server 작업이 아니라면 괜찮을것이다. 